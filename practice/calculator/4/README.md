# è®¡ç®—å™¨è¾“å…¥æ’¤é”€ã€é‡åšå’Œåˆ é™¤

åˆ é™¤ã€æ’¤é”€å’Œé‡åšåŠŸèƒ½æ˜¯å¾ˆå¤šè¾“å…¥ç±»ç¨‹åºéƒ½æœ‰çš„åŠŸèƒ½ï¼Œåœ¨åŸæœ‰è®¡ç®—å™¨åŸºç¡€ä¸Šå¢åŠ è¿™æ’¤é”€ã€é‡åšå’Œåˆ é™¤åŠŸèƒ½ã€‚

## é™åˆ¶

- ä½ ä¸å¯ä»¥ä½¿ç”¨ `eval()` å‡½æ•°æ¥æ‰§è¡Œè®¡ç®—
- ä½ ä¸å¯ä»¥ä½¿ç”¨ `new Function('...')` å‡½æ•°æ¥æ‰§è¡Œè®¡ç®—

## ç”¨ä¾‹

1. ç”¨æˆ·å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå±æ˜¾ç¤ºå½“å‰è¾“å…¥çš„æ•°å­—æˆ–æœ€åä¸€æ¬¡æ“ä½œçš„ç»“æœã€‚
2. ç”¨æˆ·å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåŒ…å«æ•°å­— 0-9ã€æ“ä½œç¬¦ â€”â€” '+'ã€'-'ã€'*'ã€'/'ã€'='ã€'â†©'ã€'â†ª' å’Œ 'ğŸ…§' æŒ‰é’®çš„è¾“å…¥æ¿ï¼Œä¸€ä¸ª 'AC' æŒ‰é’®ï¼ˆç”¨äºæ¸…é™¤æ‰€æœ‰ï¼‰ã€‚
3. ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»è¾“å…¥æ¿ä¸Šçš„æ•°å­—æ¥è¾“å…¥æœ€å¤šå…«ä½æ•°çš„æ•°å­—åºåˆ—ï¼Œä»»ä½•è¶…è¿‡8ä½çš„æ•°å­—çš„è¾“å…¥éƒ½å°†è¢«å¿½ç•¥ã€‚
4. ç”¨æˆ·å¯ä»¥ç‚¹å‡» 'AC' æŒ‰é’®æ¥æ¸…é™¤æ‰€æœ‰çš„å†…éƒ¨å·¥ä½œåŒºåŸŸï¼Œå¹¶å°†æ˜¾ç¤ºå€¼è®¾ä¸º 0ã€‚
5. åˆå§‹å€¼ä¸º 0ï¼Œè¾“å…¥æ“ä½œç¬¦åˆ™ä»¥ 0 ä¸ºæ“ä½œæ•°ï¼Œå¦åˆ™æŒ‰æ”¶å…¥çš„æ•°å­—ä½œä¸ºæ“ä½œæ•°ï¼›
6. æœ€åè¾“å…¥ç­‰å·åï¼Œå°†è®¡ç®—ç»“æœä½œä¸ºä¸‹ä¸€è½®è®¡ç®—çš„åˆå§‹å€¼ï¼›
7. å½“å‰æ“ä½œæ•°ä¸º 0 æ—¶ï¼Œå†é‡å¤è¾“å…¥ 0 æ—¶éœ€è¦å¿½ç•¥ï¼Œé¿å…å‡ºç° 00000123 è¿™æ ·çš„æ˜¾ç¤ºï¼›
8. æš‚æ—¶ä¸æ”¯æŒæ•°å­—æ­£è´Ÿç¬¦å·è¾“å…¥ï¼Œæ‰€æœ‰æ“ä½œç¬¦å·éƒ½ä»¥æœ€åè¾“å…¥ä¸ºå‡†ï¼›

    ä¾‹å¦‚ï¼šç°åœ¨æ˜¯ 3 + ï¼Œå†è¾“å…¥å‡å·å˜ä¸º 3 -

9. å¦‚æœä¸Šä¸€æ¬¡è¾“å…¥çš„æ˜¯æ“ä½œç¬¦ï¼Œç°åœ¨è¾“å…¥ç­‰å·æ”¯æŒè‡ªåŠ¨å»æ‰å¤šä½™çš„æ“ä½œç¬¦å†è¿›è¡Œè®¡ç®—ã€‚
10. ç‚¹å‡»åˆ é™¤æŒ‰é’® 'ğŸ…§'ï¼Œå¯ä»¥åˆ é™¤å½“å‰æ˜¾ç¤ºé¢æ¿çš„æœ€åä¸€ä¸ªå­—ç¬¦ï¼›
11. ç‚¹å‡»æ’¤é”€æŒ‰é’® 'â†©'ï¼Œå¯ä»¥æ¢å¤åˆ°ä¸Šä¸€æ¬¡è¾“å…¥çš„æƒ…å†µï¼›

    - 1 + 2 x 3 =ã€‹æ’¤é”€ =ã€‹ 1 + 2 x
    - 1 + 2 x 3 + => è¾“å…¥ - =ã€‹1 + 2 x 3 - => æ’¤é”€ =ã€‹ 1 + 2 x 3 +
    - 1 + 2 x 3 =ã€‹åˆ é™¤ =ã€‹ 1 + 2 x =ã€‹ æ’¤é”€ =ã€‹1 + 2 x 3

12. ç‚¹å‡»é‡åšæŒ‰é’® 'â†ª'ï¼Œä¸æ’¤é”€æŒ‰é’®ç›¸åï¼Œå¯ä»¥æ¢å¤æ’¤é”€çš„è¾“å…¥ï¼›

    1 + 2 x 3 =ã€‹æ’¤é”€ =ã€‹ 1 + 2 x =ã€‹é‡åš =ã€‹1 + 2 x 3

## è„šæ‰‹æ¶

https://codesandbox.io/s/calculator-4-c445xo


## å‚è€ƒ

- [Web åº”ç”¨ä¸­çš„æ’¤é”€ä¸é‡åš](https://zhuanlan.zhihu.com/p/43743782)
- [Web åº”ç”¨çš„æ’¤é”€é‡åšå®ç°](https://segmentfault.com/a/1190000020154153)
- [å®ç°æ’¤é”€é‡åš](http://cn.redux.js.org/recipes/implementing-undo-history/)
- [ã€æ•°æ®ç»“æ„ã€‘æ’¤é”€ä¸é‡åš | æ¨¡å‹å®ç°](https://blog.csdn.net/weixin_43095238/article/details/111475741)
- [Undo/Redo implementation [closed]](https://stackoverflow.com/questions/3541383/undo-redo-implementation)
